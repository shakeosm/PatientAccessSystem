@using Pas.Service.Interface

@model Pas.Web.ViewModels.PrescriptionCreateVM
@inject IDrugService DrugService

@{    
    var clinicalInfo = Model.ClinicialInfo;
    var recentMedications = clinicalInfo.RecentMedication.Take(6);
    //var recentDiagnosis = clinicalInfo.RecentDiagnosis;
    var allergyList = clinicalInfo.AllergyList;

    var symptomList = await DrugService.ListAllSymptoms();
    var symptomListSource = new SelectList(symptomList, "Id", "Description");

    int counter = 0;
}
<div id="PatientHistory" class="form-row w-100 mb-2 bg-white border rounded ml-2 pt-2 no-print">

    <!-- Name/Age/Gender amd Address -->
    <div id="LeftColumn" class="col-sm-12 col-md-6 pl-3">
        <div id="PersonalDetails" class="">

            <!-- CC: Chief Complaints -->
            @*https://stackoverflow.com/questions/34624034/select-tag-helper-in-asp-net-core-mvc*@
            <div class="form-row col-12 mb-3">
                <label for="ChiefComplaintTextArea" class="col-sm-2 form-label">Chief complaints</label>
                <div class="col-sm-10">
                    @Html.DropDownList("ChiefComplaintList", symptomListSource, "Select a CC",
                            new
                                 {
                                     id = "ChiefComplaintList",
                                     @class = "form-control",
                                multiple = "multiple",
                                     placeholder = "Select a CC",
                                     style = "width:100%;"
                                 })

                    <span class="help-block">Select at least on CC</span>
                </div>

            </div>

        </div>

        <div id="ClinicalHistory" class="col-12 invisible d-none">
            <!-- Vitals -->
            <div id="PatientHistoryTopRow" class="col-12 form-row mb-3">
                <div class="flex-column vital-info-box shadow-sm">
                    <span class="vital-info-box-header">Blood</span>
                    <h1 class="font-large">O+</h1>
                </div>
                <div class="flex-column vital-info-box shadow-sm">
                    <span class="vital-info-box-header">Blood pressure</span>
                    <h1 class="font-large">120/80</h1>
                </div>
                <div class="flex-column vital-info-box shadow-sm">
                    <span class="vital-info-box-header">Pulse</span>
                    <h1 class="font-large">70</h1>
                </div>
                <div class="flex-column vital-info-box shadow-sm">
                    <span class="vital-info-box-header">RBS</span>
                    <h1 class="font-large">6.5 mmol/L</h1>
                </div>
            </div>
        </div>

    </div>

    <!-- Past medical History and Recent Medication -->
    <div id="RightColumn" class="col-sm-12 col-md-6">

        <div class="accordion" id="PatientClinicalDetailsAccordion">

            <div class="card DiagnosisAccordion">
                <div class="card-header">
                    <a href="javascript:void(0);" class="card-title px-3 py-2 bg-warning-500 text-dark collapsed" data-toggle="collapse" data-target="#DiagnosisAccordion" aria-expanded="false">
                        <i class="fas fa-procedures fa-lg mr-2"></i>Past Medical History: <!-- Past Medical History -->

                        <span class="ml-auto">
                            <span class="collapsed-reveal">
                                <i class="fal fa-minus fs-xl"></i>
                            </span>
                            <span class="collapsed-hidden">
                                <i class="fal fa-plus fs-xl"></i>
                            </span>
                        </span>
                    </a>
                </div>
                <div id="DiagnosisAccordion" class="collapse" data-parent="#PatientClinicalDetailsAccordion" style="">
                    <div class="card-body bg-success p-3">
                        @*@if (recentDiagnosis != null && recentDiagnosis.Count() > 0)
                        {
                            @foreach (var item in recentDiagnosis)
                            {
                                <span class="alert alert-danger p-2 mr-1">@item.Name</span>
                            }
                        }
                        else
                        {
                            <span class="h4 text-info">No recent Diagnosis found</span>
                        }*@
                    </div>
                </div>
            </div>
            <div class="card RecentMedicationsAccordion">
                <div class="card-header">
                    <a href="javascript:void(0);" class="card-title px-3 py-2 bg-info-700 text-white collapsed" data-toggle="collapse" data-target="#RecentMedicationsAccordion" aria-expanded="false">
                        <i class="fas fa-prescription fa-lg mr-2"></i>Recent Medications (top 6):
                        <span class="ml-auto">
                            <span class="collapsed-reveal">
                                <i class="fal fa-minus fs-xl"></i>
                            </span>
                            <span class="collapsed-hidden">
                                <i class="fal fa-plus fs-xl"></i>
                            </span>
                        </span>
                    </a>
                </div>
                <div id="RecentMedicationsAccordion" class="collapse" data-parent="#PatientClinicalDetailsAccordion" style="">
                    <div class="card-body bg-info-50 p-2">
                        <div class="d-flex flex-wrap">
                            @if (recentMedications != null && recentMedications.Count() > 0)
                            {
                                @foreach (var item in recentMedications)
                                {
                                    <span class="clinical-info-item">@item.Name - @item.Dosage</span>
                                }
                            }
                            else
                            {
                                <span class="h4 text-info">No recent Medication found</span>
                            }

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <div class="row">

        <div id="PatientHistorySecondRow" class="col-12 mt-2 form-row pt-2 pb-4 border-bottom">


        </div>
    </div>
</div>